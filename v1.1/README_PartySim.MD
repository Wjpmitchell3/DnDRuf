# **PartySim.R** v 1.1 Updates

## - **Headlines** -

### Function Name Change
It had occurred to me too late that in order for ```FighterSim()``` to develop more, I will likely need to develop separate functions for the generation of different classes of characters, simply due to the heterogeneity present in 5e class types. I may very well one day have a ```SorcererSim()``` and a ```PaladinSim()```, etc. As such, ```FighterSim()``` is unfortunately named and has been renamed in this patch to ```PartySim()```, since what we're really aiming to do is create a party of combatants to enter combat with.

### Error Messages
The function will now offer more precise error messages when values and vectors entered into the function prevent the function from operating as designed. 

### Removed Initiative Rolls
Initiative Rolls were previously generated using this function, but I would like this function to be able to stand on its own, separate from ```CombatSim()```, so a new function called ```InitiatSim()``` was written and included within ```CombatSim()```

### Quantity of Groups
In previous iterations, this function has only been able to generate characters which belong to one of two groups. Now, ```PartySim()``` will allow you to generate as many characters for as few or as many groups as you like. Default values have been updated accordingly. 

### Maximum HP and AC Ranges
Arguments allowing users so specify upper and lower ranges for each group's maximum hit points and armor class have been added.

### Name & Gender Generation
The ```CivSim()``` function has now been incorporated into the ```FighterSim()``` function to generate names for each fighter that are influenced by a fighter's gender and cultural/familial history. Of the fighters generated, about 80.0% will be males, 19.6% will be females, and 0.04% will be nonbinary individuals by default. These values can be manipulated with the ```Gender =``` argument.

### Ability Scores & Modifiers
The simulator will now randomly generate ability scores for Strength, Dexterity, Constitution, Intelligence, Wisdom, and Charisma. Much like a typical tabletop RPG, the range of possible values is between 3 and 18. Modifiers are calculated as they traditionally are in a tabletop RPG, as well. Unfortunately, it does not, at the moment, allow you to assign your rolls to your abilities as desired. 

### Inventory - Health Potions
The simulator will now randomly generate a certain number of health potions within each fighter's inventory. The quality of potions can range from standard to supreme and the quantity can range from 0 to 20. The average generated fighter will start with 2 standard healing potions, 0.8 greater healing potions, 0.4 superior healing potions, 0.04 supreme healing potions.    

## - **Details** -

### Error Messages
Error messages will now highlight to users when the value they've entered are outside of the possible range that R can reasonably process (e.g., asking R to generate -2 groups), or outside of the range of values reasonable for a 5e Tabletop (e.g., -5 max HP). Additionally, if you use the new range functions for AC and HP, R will tell you when you have no entered a range large enough for it to work with (e.g., if you set ```HPmax_Low``` and ```HPmax_Up``` both to the same value). Lastly, the function will also recognize when you've entered vectors of a length different than the number of groups you've asked for (e.g., You set ```nGroups``` to 4, but only provide three values for the ```AC``` vector). 

### Quantity of Groups
Notably, default values have been set for ***ALL*** variables and those defaults will adjust according to whatever you set ```nGroup``` to. If you were to simply enter ```PartySim()``` in the console, it would work just fine, generating 1 group of 6 fighters. However, if you were to enter ```PartySim(nGroup = 3)```, you would get 3 groups, each with 6 fighters, and you would not need to change any other variable vectors to make this work. 

### Maximum HP and AC Ranges
In its previous iteration, this function had used HP and AC ranges from [this post](https://www.quora.com/Whats-the-highest-HP-a-5e-D-D-character-can-have-without-relying-on-luck#:~:text=If%20your%20group%20plays%20with%20optional%20rules%2C%20there%20is%20also%20if%20you%20don't.) and [this post](https://rpg.stackexchange.com/questions/67197/what-is-the-highest-possible-ac), which highlight the maximum and minimum values for standard fighters with at least some sort of armor. These values were applied to all fighters, but there might be a case where you would want to have granular control over the possible generation range for each group separately, which you now can do. Additionally, while such high and low AC and HP values were technically possible, the upper and lower bounds of these ranges are very uncommon, and I wasn't able to derive a satisfying positively skewed probability distribution to make the simulation realistic using these ranges. Therefore, I set the default range to an arbitrary ```20:245``` and ```8:26``` for HP and AC respectively. They both also use an exponential distribution, much like the health potions, to make lower values more likely to generate than higher values. Again, these ranges can easily be changed through manual specification using the ```*_Low``` and ```*_Up``` arguments, and if you don't want to rely on simulation, you can also manually specify what you want AC and HP to be using ```AC = ``` and ```HPmax = ```.

### Name & Gender Generation
Under-the-hood details for this function can be found within the ```CivSim()``` function README. ```CivSim()``` randomly assigns background information (i.e., gender, familial occupational history, and cultural origin) to each person and then randomly selects names based upon these criteria. For the time being, I do not provide an option to carry forward and of this background information into the ```FighterSim()``` dataframe, though, the function could be modified easily to do so, if you so choose. I'm trying to be economical about column space. The default proportions in the ```CivSim()``` function, which mirror those found within the real world (~48% Male, 51% Female, 1% Nonbinary) differ substantially from those generated in the ```FighterSim()``` function. I debated back and forth with myself as to what the default proportions of the gender generator here should be, as continuing to generate predominantly male cahracters might perpetuate the notion that tabletop RPGs are for men, but I ultimately decided to reflect proportions that might approximate real world fighter groups, which are often predominantly male.

### Ability Scores & Modifiers
I use the ```rollr::roll_dice("4d6h3")``` package, function, and argument to roll 4 dice and keep the highest three values, much as you normally would in a character creation situation. The modifiers are calculated by specifying ```floor(([Ability Score] - 10) / 2)``` or ```ceiling(([Ability Score] - 10) / 2)```, depending upon whether the ability scores are above 10 or below, respectively. Without both the ```ceiling()``` and ```floor()``` rounding functions, it might be the case that someone with a 7 might have a modifier of -2 and someone with a 13 might have a modifier of +2.

### Inventory - Health Potions
This will generate four new columns named ```nHealStd```, ```nHealGtr```, ```nHealSuper```, and ```nHealSuprm``` which will track the quantity that each fighter possesses of each. To make quantities more realistic, I used the ```sample()``` function and placed an exponential distribution for the generative probabilities. So the probability of generating a fighter with 0 standard health potions is 1.5 times greater than generating a fighter with 1 standard  health potion, and about 2981 times more likely than generating a fighter with 20 standard health potions. For the math nerds among us, I set the probability argument for standard heal potions to ```prob = exp((1 * 0.4) * (20:0))```, wherein the first component ```(1 * 0.4)``` modulates the rate of the slope, with smaller values making the visualized dip less dramatic. To simulate the relative scarcity of stronger healing potions, I increased the first term of the slope of the exponential distribution by one with each increased scarcity level. So, to put it plainer English, the slope component of greater healing potions changes to ```(2 * 0.4)```, the slope component of superior healing potions changes to ```(3 * 0.4)```, and the slope component of supreme healing potions changes to ```(4 * 0.4)```. This makes greater quantities of each substantially less likely as the strength level increases. For example, the probability of generating a fighter with 0 supreme health potions is 24.5 times more likely than generating a fighter with 1 supreme health potion, and roughly 62,351,490,000,000,000,000,000,000 times more likely than generating a fighter with 20 supreme health potions. There rates have been entirely subjectively decided. To arrive at these values, I simply had the ```sample()``` function sample from this distribution 10,000 times and produce the mean value of the subsequent array. Due to the central limit theorem, the mean of such a large sample would be a pretty reliable indicator of how many potions, on average, we could expect a fighter to start with. The code for this was ```mean(sample(x = 0:20, size = 10000, replace = T, prob = exp((1 * 0.4) * (20:0))))``` where I tweaked the slope value ```(1 * 0.4)``` until it produced an average of 2 standard healing potions. In my years of playing D&D this felt like a realistic quantity to have in an inventory. I then increased by 1 and found that it yielded rates that felt realistic. The averages for the other healing potions were about 0.8 (greater), 0.4 (superior), and 0.04 (supreme). To put that in other words, If we generated 100 fighters, all would have about 2 standard healing potions, 80 would have about 1 greater healing potion, 40 would have about 1 superior healing potion, and only 4 out of the 100 would have a supreme healing potion.  
